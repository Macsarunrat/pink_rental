{% extends 'base.html' %} {% block content %}
<div class="text-center mb-4">
  <h4>
    ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö:
    <span class="text-primary">{{ rental.dress.name }}</span>
  </h4>
  <p class="text-muted">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 2 ‡∏ä‡∏¥‡πâ‡∏ô (‡∏ü‡∏£‡∏µ!)</p>
</div>

<form method="post">
  {% csrf_token %}

  <div class="row g-2">
    {% for acc in accessories %} {% if acc.id in booked_acc_ids %}
    <div class="col-6 col-md-3">
      <div
        class="card h-100 p-2 text-center bg-light border-0 opacity-50 position-relative"
      >
        <div
          class="position-absolute top-50 start-50 translate-middle w-100"
          style="z-index: 2"
        >
          <span class="badge bg-danger fs-6 shadow">üö´ ‡∏Ñ‡∏¥‡∏ß‡πÄ‡∏ï‡πá‡∏°</span>
          <div class="text-dark small mt-1 bg-white rounded px-1 fw-bold">
            (‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡πà‡∏≤)
          </div>
        </div>

        {% if acc.image %}
        <img
          src="{{ acc.image.url }}"
          class="rounded mb-2 w-100"
          style="height: 100px; object-fit: cover; filter: grayscale(100%)"
        />
        {% else %}
        <div
          class="bg-secondary rounded mb-2 d-flex align-items-center justify-content-center text-white"
          style="height: 100px"
        >
          üíé
        </div>
        {% endif %}
        <small class="text-muted text-decoration-line-through"
          >{{ acc.name }}</small
        >
      </div>
    </div>

    {% else %}
    <div class="col-6 col-md-3">
      <input
        type="checkbox"
        name="accessories"
        value="{{ acc.id }}"
        id="acc_{{ acc.id }}"
        class="acc-checkbox d-none"
        {%
        if
        acc
        in
        rental.accessories.all
        %}checked{%
        endif
        %}
      />

      <label
        for="acc_{{ acc.id }}"
        class="card h-100 p-2 text-center acc-card position-relative border-2"
      >
        <div
          class="check-mark position-absolute top-0 end-0 m-1"
          style="display: none"
        >
          <i class="bi bi-check-circle-fill text-success fs-4"></i>
        </div>

        {% if acc.image %}
        <img
          src="{{ acc.image.url }}"
          class="rounded mb-2 w-100"
          style="height: 100px; object-fit: cover"
        />
        {% else %}
        <div
          class="bg-light rounded mb-2 d-flex align-items-center justify-content-center"
          style="height: 100px"
        >
          üíé
        </div>
        {% endif %}
        <small class="fw-bold">{{ acc.name }}</small>
      </label>
    </div>
    {% endif %} {% endfor %}
  </div>

  <div class="fixed-bottom p-3 bg-white border-top shadow text-center">
    <span id="count-display" class="me-3 fw-bold text-primary"
      >‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß 0/2 ‡∏ä‡∏¥‡πâ‡∏ô</span
    >
    <button type="submit" class="btn btn-success rounded-pill px-5 fw-bold">
      ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‚úÖ
    </button>
  </div>
</form>

<style>
  /* CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) */
  .acc-checkbox:checked + .acc-card {
    border-color: #ff69b4;
    background-color: #fff0f5;
  }
  .acc-checkbox:checked + .acc-card .check-mark {
    display: block;
  }

  /* ‡∏ï‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏´‡∏°‡∏î‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤ ‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡∏π‡∏à‡∏≤‡∏á‡πÜ */
  .acc-card.disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
</style>

<script>
  // JavaScript ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô 2 ‡∏ä‡∏¥‡πâ‡∏ô
  const checkboxes = document.querySelectorAll(".acc-checkbox");
  const maxAllowed = 2;
  const countDisplay = document.getElementById("count-display");

  function updateCount() {
    let checkedCount = document.querySelectorAll(
      ".acc-checkbox:checked"
    ).length;
    countDisplay.textContent = `‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß ${checkedCount}/${maxAllowed} ‡∏ä‡∏¥‡πâ‡∏ô`;

    // ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏£‡∏ö 2 ‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏∑‡πà‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠
    checkboxes.forEach((box) => {
      if (!box.checked) {
        if (checkedCount >= maxAllowed) {
          box.disabled = true;
          box.nextElementSibling.classList.add("disabled");
        } else {
          box.disabled = false;
          box.nextElementSibling.classList.remove("disabled");
        }
      }
    });
  }

  checkboxes.forEach((box) => box.addEventListener("change", updateCount));
  updateCount(); // ‡∏£‡∏±‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ç‡∏≠‡∏á‡πÄ‡∏Å‡πà‡∏≤
</script>
<br /><br /><br />
{% endblock %}
