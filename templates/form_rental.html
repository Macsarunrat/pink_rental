{% extends 'base.html' %}

{% block content %}
<style>
  /* CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÅ‡∏ö‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û */
  .acc-checkbox { display: none; }
  .acc-card {
    cursor: pointer;
    border: 2px solid #ddd;
    border-radius: 10px;
    transition: all 0.2s;
    opacity: 0.7;
  }
  .acc-card:hover { transform: translateY(-3px); }
  .acc-checkbox:checked + .acc-card {
    border-color: #ff69b4;
    background-color: #fff0f5;
    opacity: 1;
    box-shadow: 0 4px 10px rgba(255, 105, 180, 0.3);
  }
  .check-mark { display: none; }
  .acc-checkbox:checked + .acc-card .check-mark { display: block; }
</style>

<div class="card shadow border-0 p-4">
  <h3 class="mb-4 text-primary">üìù ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πà‡∏≤‡∏ä‡∏∏‡∏î + ‡πÅ‡∏ñ‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö</h3>

  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}

    {% if form.errors %}
        <div class="alert alert-danger">
            <strong>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ! ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:</strong>
            {{ form.errors }}
        </div>
    {% endif %}

    <div class="row">
      <div class="col-md-6 mb-3">
        <label class="form-label fw-bold">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</label>
        <div class="input-group">
            {{ form.customer }}
            
            <a href="{% url 'add_customer' %}" class="btn btn-outline-primary" target="_blank">
                <i class="bi bi-person-plus-fill"></i> ‡πÉ‡∏´‡∏°‡πà
            </a>
        </div>
        <div class="form-text text-muted small">*‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠ (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° '‡πÉ‡∏´‡∏°‡πà')</div>
      </div>
      
      <div class="col-md-6 mb-3">
        <label class="form-label fw-bold">‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡πà‡∏≤</label>
        {{ form.dress }}
      </div>
    </div>

    <div class="row">
      <div class="col-md-6 mb-3">
        <label class="form-label fw-bold">‡∏ß‡∏±‡∏ô‡∏£‡∏±‡∏ö‡∏ä‡∏∏‡∏î</label>
        {{ form.start_date }}
      </div>
      <div class="col-md-6 mb-3">
        <label class="form-label fw-bold">‡∏ß‡∏±‡∏ô‡∏Ñ‡∏∑‡∏ô‡∏ä‡∏∏‡∏î</label>
        {{ form.end_date }}
      </div>
    </div>

    <div class="row">
        <div class="col-md-6 mb-3">
            <label class="form-label fw-bold">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏© (‡∏ö‡∏≤‡∏ó)</label>
            {{ form.price_override }}
            <div class="form-text text-muted small">‡πÉ‡∏™‡πà‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥)</div>
        </div>
        <div class="col-md-6 mb-3">
            <label class="form-label fw-bold">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
            {{ form.note }}
        </div>
    </div>

    <hr class="my-4 text-muted" />

    <label class="form-label fw-bold mb-3 d-block">üíé ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÅ‡∏ñ‡∏° (‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢)</label>

    <div class="row g-2" style="max-height: 400px; overflow-y: auto;">
      {% for acc in accessories %}
      <div class="col-4 col-sm-3 col-md-2">
        <input type="checkbox" name="accessories" value="{{ acc.id }}" id="acc_{{ acc.id }}" class="acc-checkbox"/>

        <label for="acc_{{ acc.id }}" class="card h-100 p-2 text-center acc-card position-relative">
          <div class="check-mark position-absolute top-0 end-0 m-1">
            <i class="bi bi-check-circle-fill text-success fs-5"></i>
          </div>

          {% if acc.image %}
          <img src="{{ acc.image.url }}" class="rounded mb-1" style="width: 100%; height: 60px; object-fit: cover"/>
          {% else %}
          <div class="bg-light rounded mb-1 d-flex align-items-center justify-content-center" style="height: 60px">üíé</div>
          {% endif %}

          <small style="font-size: 0.75rem">{{ acc.name }}</small>
        </label>
      </div>
      {% endfor %}
    </div>

    <hr class="my-4" />

    <button type="submit" class="btn btn-primary w-100 rounded-pill py-2 fw-bold">
      ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πà‡∏≤
    </button>
  </form>
</div>
{% endblock %}