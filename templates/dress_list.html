{% extends 'base.html' %}
{% load humanize %}

{% block content %}
<style>
    /* üîß CSS ‡∏à‡∏±‡∏î‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û */
    .dress-card-img {
        height: 280px; /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏´‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡πÉ‡∏ö */
        width: 100%;
        object-fit: cover; /* ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏ï‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡∏≠‡∏≠‡∏Å ‡∏£‡∏π‡∏õ‡πÑ‡∏°‡πà‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ß */
        object-position: top center; /* ‡πÉ‡∏´‡πâ‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏á‡∏ö‡∏ô‡∏Ç‡∏≠‡∏á‡∏ä‡∏∏‡∏î (‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏£‡∏π‡∏õ‡∏¢‡∏≤‡∏ß) */
        transition: transform 0.3s ease;
    }

    /* Effect ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡∏ï‡∏≠‡∏ô‡πÄ‡∏≠‡∏≤‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏ä‡∏µ‡πâ */
    .card:hover .dress-card-img {
        transform: scale(1.05);
    }
    
    .img-wrapper {
        overflow: hidden; /* ‡∏ã‡πà‡∏≠‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏¢‡∏≤‡∏¢‡πÄ‡∏Å‡∏¥‡∏ô‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ */
        border-top-left-radius: 15px;
        border-top-right-radius: 15px;
        position: relative;
    }

    /* ‡∏õ‡πâ‡∏≤‡∏¢‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ */
    .status-badge {
        position: absolute;
        top: 10px;
        right: 10px;
        padding: 5px 12px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: bold;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
</style>

<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h2 class="text-primary mb-0">üëó ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ä‡∏∏‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
        <p class="text-muted small">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ä‡∏∏‡∏î‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≥‡πÑ‡∏£</p>
    </div>
    <a href="{% url 'add_dress' %}" class="btn btn-primary rounded-pill px-4 shadow-sm">
        + ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡∏∏‡∏î‡πÉ‡∏´‡∏°‡πà
    </a>
</div>

<div class="row g-4"> {% for dress in dresses %}
    <div class="col-6 col-md-4 col-lg-3"> <div class="card h-100 shadow-sm border-0">
            
            <div class="img-wrapper">
                {% if dress.image %}
                    <img src="{{ dress.image.url }}" class="dress-card-img" alt="{{ dress.name }}">
                {% else %}
                    <div class="dress-card-img d-flex align-items-center justify-content-center bg-light text-muted">
                        <i class="bi bi-image fs-1"></i>
                    </div>
                {% endif %}

                {% if dress.is_available %}
                    <span class="badge bg-success status-badge">‡∏ß‡πà‡∏≤‡∏á</span>
                {% else %}
                    <span class="badge bg-secondary status-badge">‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á</span>
                {% endif %}
            </div>

            <div class="card-body d-flex flex-column">
                <h5 class="card-title fw-bold text-dark mb-1">{{ dress.name }}</h5>
                <p class="text-primary fw-bold mb-3">‡∏ø{{ dress.rental_price|intcomma }} <small class="text-muted fw-normal">/ ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</small></p>
                
                <div class="mt-auto"> <div class="d-flex justify-content-between small mb-3 border-top pt-2">
                        <span class="text-muted">‡∏ó‡∏∏‡∏ô: {{ dress.cost_price|intcomma }}</span>
                        {% with p=dress.profit %}
                        <span class="fw-bold {% if p >= 0 %}text-success{% else %}text-danger{% endif %}">
                            {% if p >= 0 %}+{% endif %}{{ p|intcomma }}
                        </span>
                        {% endwith %}
                    </div>

                    <div class="d-grid gap-2 d-flex justify-content-center">
                        <a href="{% url 'edit_dress' dress.id %}" class="btn btn-sm btn-outline-warning rounded-pill flex-fill">
                            <i class="bi bi-pencil"></i> ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                        </a>
                        <a href="{% url 'delete_dress' dress.id %}" class="btn btn-sm btn-outline-danger rounded-pill flex-fill" 
                           onclick="return confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏ä‡∏∏‡∏î {{ dress.name }} ?');">
                            <i class="bi bi-trash"></i> ‡∏•‡∏ö
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% empty %}
    <div class="col-12 text-center py-5">
        <div class="text-muted mb-3"><i class="bi bi-box-seam display-1"></i></div>
        <h4>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏∏‡∏î‡πÉ‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å</h4>
        <p class="text-muted">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡∏∏‡∏î‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</p>
    </div>
    {% endfor %}
</div>
{% endblock %}